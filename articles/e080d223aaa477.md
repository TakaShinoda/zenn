---
title: 'Vite ã‚’ç”¨ã„ãŸ Module Federation ã«ã‚ˆã‚‹ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ã‚„ã£ã¦ã¿ãŸ'
emoji: 'ğŸ”–'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['vite', 'microfrontend']
published: false
---

# ã¯ã˜ã‚ã«

## Module Federation

[Module Federation](https://webpack.js.org/concepts/module-federation/) ã¯ã€webpack5 ã®æ©Ÿèƒ½ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šåˆ¥ã®ãƒãƒ³ãƒ‰ãƒ«ã®ã‚³ãƒ¼ãƒ‰ã‚’å‹•çš„ã«å®Ÿè¡Œã§ãã¾ã™ã€‚ã¾ãŸä»¥ä¸‹ 2 ã®æ¦‚å¿µãŒã‚ã‚Šã¾ã™ã€‚

- ãƒ›ã‚¹ãƒˆ
  - ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠ
- ãƒªãƒ¢ãƒ¼ãƒˆ
  - ãƒ›ã‚¹ãƒˆã§ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ JS ãƒãƒ³ãƒ‰ãƒ«

![](https://storage.googleapis.com/zenn-user-upload/ffcd0b18fb48-20250407.png)

## ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ¦‚å¿µã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¸–ç•Œã«ã¾ã§æ‹¡å¼µã—ãŸã‚‚ã®ã§ã™ã€‚

> We're seeing an approach emerge that our teams call micro frontends. In this approach, a web application is broken up by its pages and features, with each feature being owned end-to-end by a single team. Multiple techniques exist to bring the application featuresâ€”some old and some newâ€”together as a cohesive user experience, but the goal remains to allow each feature to be developed, tested and deployed independently from others. The BFF - backend for frontends approach works well here, with each team developing a BFF to support its set of application features.

https://www.thoughtworks.com/radar/techniques/micro-frontends

![](https://storage.googleapis.com/zenn-user-upload/45f2a2d54b36-20250407.png)

![](https://storage.googleapis.com/zenn-user-upload/65ac447eb9e8-20250407.png)

# ä½œã£ãŸã‚‚ã®

ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ç”»é¢ã§ã™ã€‚

æ°´å¹³åˆ†å‰²ã§ä»¥ä¸‹ 3 ã¤ã®ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒ 1 ã¤ã®ç”»é¢ä¸Šã«å­˜åœ¨ã—ã¾ã™ã€‚

- æ¦‚è¦ MFE
  - ç·‘ã®éƒ¨åˆ†
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ MFE
  - é’ã®éƒ¨åˆ†
- è©³ç´° MFE
  - ã‚ªãƒ¬ãƒ³ã‚¸ã®éƒ¨åˆ†

![ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼å›³é‘‘ã®ç”»åƒ](https://storage.googleapis.com/zenn-user-upload/b68bdd972f55-20250407.png)

https://github.com/TakaShinoda/my-mfe

ä»Šå›ã¯å˜ä¸€ã®ãƒªãƒã‚¸ãƒˆãƒªã«å„ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚

```
.
â”œâ”€â”€ app-shell
â”œâ”€â”€ details
â”œâ”€â”€ overview
â””â”€â”€ stats
```

# è©³ç´°

ä¸Šè¿°ã—ãŸã‚ˆã†ã«ã€Module Federation ã¯ webpack5 ã®æ©Ÿèƒ½ã§ã™ã€‚Vite ã§åŒæ§˜ãªã“ã¨ã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ã€ç¾æ™‚ç‚¹ã§ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯ã€[vite-plugin-federation](https://github.com/originjs/vite-plugin-federation) ã‚’ä½¿ã„ã¾ã™ã€‚

ãƒªãƒ¢ãƒ¼ãƒˆå´ã¨ãƒ›ã‚¹ãƒˆå´ãã‚Œãã‚Œã§ã€`vite.config.ts` ã« `vite-plugin-federation` ã‚’ä½¿ã£ãŸ Module Federation ã®è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚

## ãƒªãƒ¢ãƒ¼ãƒˆå´

### name

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å

### filename

ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«åã€‚

ä»»æ„é …ç›®ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `remoteEntry.js` ã¨ãªã‚‹ã€‚

### exposes

ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ã€ä¸€èˆ¬ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã€‚

`'å¤–éƒ¨å…¬é–‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå': 'å¤–éƒ¨å…¬é–‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹'` ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã€‚

ã“ã®ä¾‹ã§ã¯ `components/Overview.tsx` ã‚’ `Overview` ã¨ã—ã¦å…¬é–‹ã€‚

### shared

ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å…±æœ‰ã•ã‚Œã‚‹ä¾å­˜é–¢ä¿‚

ã“ã‚Œã«ã‚ˆã‚Šã€ä¾‹ãˆã° MFE ãŒ 3 ã¤ã‚ã‚Šã€ãã‚Œãã‚Œ Vue3.5 ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã€Vue3.5 ã‚’ 3 å›èª­ã¿è¾¼ã‚€å¿…è¦ãŒãªããªã‚‹ã€‚

```ts: vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import federation from '@originjs/vite-plugin-federation'

export default defineConfig({
  plugins: [
    react(),
    federation({
      name: 'remote_overview_app',
      filename: 'remoteEntry.js',
      exposes: {
        './Overview': './src/components/Overview'
      },
      shared: ['react','react-dom']
    })
  ],
  preview: {
    port: 5000,
    strictPort: true
  }
})
```

## ãƒ›ã‚¹ãƒˆå´

### remotes

ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å‚ç…§ã•ã‚Œã‚‹ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¨ãƒ³ãƒˆãƒªãƒ•ã‚¡ã‚¤ãƒ«

`'ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å'': 'ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹'` ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã€‚

ã“ã®ä¾‹ã§ã¯ `overviewApp` ã¨ã—ã¦å…ˆã»ã©ã® `Overview` ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æŒ‡å®š

```ts: vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import federation from '@originjs/vite-plugin-federation'

export default defineConfig({
  plugins: [
    react(),
    federation({
      name: 'app_shell',
      remotes: {
        overviewApp: 'http://localhost:5000/assets/remoteEntry.js'
      },
      shared: ['react','react-dom']
    })
  ]
})
```

ä»¥ä¸‹ã®ã‚ˆã†ã«ã€`overviewApp/Overview` ã‹ã‚‰ `Overview.tsx` ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ä½¿ã†ã€‚

```tsx: App.tsx
import { Overview } from 'overviewApp/Overview'

function App() {
  return (
    <main>
      <Overview />
    </main>
  )
}

export default App
```

# ãŠã‚ã‚Šã«

ä»Šå›ã¯ã€Vite + [vite-plugin-federation](https://github.com/originjs/vite-plugin-federation) ã‚’ç”¨ã„ã¦ã€ç°¡æ˜“çš„ãª MFE ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

Module Federation ã«ã‚ˆã‚‹ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã‚ˆã‚Šã€å¤§è¦æ¨¡ãªãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’åˆ†å‰²ã—ã¦é–‹ç™ºã®åŠ¹ç‡ã‚’å‘ä¸Šã•ã›ãŸã‚Šã€1 ã¤ã® MFE ã‚’è¤‡æ•°ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ã„å›ã™ã“ã¨ãŒã§ãã‚‹ã®ã§ã¯ã¨æ€ã„ã¾ã—ãŸã€‚

ã¾ãŸå…ˆæ—¥ä»¥ä¸‹ã®ã‚ˆã†ãªãƒã‚¹ãƒˆãŒã‚ã‚Šã¾ã—ãŸã€‚ä»Šå¾Œ Vite ã« Module Federation ã®ã‚µãƒãƒ¼ãƒˆãŒçµ„ã¿è¾¼ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã‚¦ã‚©ãƒƒãƒã—ã¦ã„ããŸã„ã§ã™ã€‚

https://x.com/youyuxi/status/1891107914682696090

# å‚è€ƒ

https://webpack.js.org/concepts/module-federation/

https://www.oreilly.co.jp/books/9784814400027/

https://github.com/originjs/vite-plugin-federation

https://github.com/aws-samples/talk-dev-to-me-twitch/tree/main/micro-frontends-module-federation
