---
title: 'package.json ã‚‚ lint ã™ã‚‹'
emoji: 'ğŸ§‘â€ğŸ«'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['packagejson', 'lint']
published: true
---

# ã¯ã˜ã‚ã«

ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆé–‹ç™ºã«ãŠã„ã¦ã€[ESLint](https://eslint.org/) ã‚„ [Stylelint](https://stylelint.io/) ã‚’ã¯ã˜ã‚ã¨ã™ã‚‹ linter ã¯ç„¡ãã¦ã¯ãªã‚‰ãªã„ã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã€‚

`package.json` ã«ãŠã„ã¦ã‚‚ã€ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªæ±ºã¾ã‚Šäº‹ã‚’ linter ã®æ©æµã«ã‚ˆã£ã¦æ‹…ä¿ã§ããªã„ã‹è€ƒãˆèª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

- `scripts` ã‚’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«å®šç¾©ã™ã‚‹
- ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ `0` ç³»ã§ã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯å…¥ã‚Œãªã„
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼ˆ`~` ã‚„ `^` ã‚’ã¤ã‘ãªã„ï¼‰

# npm-package-json-lint

`package.json` ç”¨ã® linter ã¨ã—ã¦ npm-package-json-lint ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã—ãŸã€‚

https://github.com/tclindner/npm-package-json-lint

ã“ã¡ã‚‰ã‚’ä½¿ã†ã“ã¨ã§ã€ä¸Šè¨˜æ±ºã¾ã‚Šäº‹ã‚’ linter ã®æ©æµã«ã‚ˆã£ã¦æ‹…ä¿ã§ããã†ãªã®ã§å®Ÿéš›ã«å°å…¥ã—ã¦ã¿ã¾ã™ã€‚

## å‰æ

ä»Šå›ã¯å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å°å…¥ã—ã¦ã¿ã¾ã™ã€‚ç¾çŠ¶ã® `package.json` ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

https://github.com/TakaShinoda/portfolio_v4.0/blob/24ad9d182c0b456277eba6bab486eaf53af0d2be/package.json

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
npm install --save-dev npm-package-json-lint
```

https://npmpackagejsonlint.org/docs/install

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã ã‘ã§ã¯ã€ã¾ã ä½•ã‚‚ãƒ«ãƒ¼ãƒ«ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ãªã„ã®ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```js: npmpackagejsonlint.config.js
const config = {
  // å¾Œã»ã©è¨˜è¿°
}

module.exports = config
```

https://npmpackagejsonlint.org/docs/configuration

## scripts ã®å®šç¾©

npm-package-json-lint ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã® `scripts` ã‚’ `package.json` ã«å®šç¾©ã—ã¾ã™ã€‚

```json: package.json
"scripts": {
  "lint:package": "npmPkgJsonLint ."
}
```

https://npmpackagejsonlint.org/docs/cli/

## ãƒ«ãƒ¼ãƒ«

npm-package-json-lint ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ«ã¯è±Šå¯Œã«ã‚ã‚Šã¾ã™ãŒã€å¤§ããåˆ†é¡ã™ã‚‹ã¨ä»¥ä¸‹ã® 8 ã¤ã§ã™ã€‚

- Require node rules
- Type rules
- Valid value rules
- Dependency rules
- Scripts rules
- Format rules
- Package.json property rules
- Disallowed node rules

ãã‚Œãã‚Œã®åˆ†é¡ã®ä¸­ã«ã•ã‚‰ã«ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚è©³ã—ãã¯ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

https://npmpackagejsonlint.org/docs/rules/

## ãƒ«ãƒ¼ãƒ«ã®è¨­å®š

å†’é ­ã§è¨˜è¿°ã—ãŸæ±ºã¾ã‚Šã”ã¨ã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚Œã°è‰¯ã•ãã†ã§ã™ã€‚

- Scripts rules
  - prefer-alphabetical-scripts
- Dependency rules
  - prefer-no-version-zero-dependencies
  - prefer-no-version-zero-devDependencies
  - prefer-absolute-version-dependencies
  - prefer-absolute-version-devDependencies

### scripts ã‚’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«å®šç¾©ã™ã‚‹

`prefer-alphabetical-scripts` ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã“ã¨ã§ã€`scripts` ãŒã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã§ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã§ãã¾ã™ã€‚

```diff: npmpackagejsonlint.config.js
const config = {
  rules: {
+   'prefer-alphabetical-scripts': 'error'
  }
}

module.exports = config
```

npm-package-json-lint ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚
ç¾çŠ¶ã® `package.json` ã¯ `scripts` ãŒã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã§ãªã„ãŸã‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã—ãŸã€‚

```
$ npm run lint:package

> lint:package
> npmPkgJsonLint .


./package.json
âœ– prefer-alphabetical-scripts - node: scripts - Your scripts are not in alphabetical order. Please move dev after build.
1 error
0 warnings
```

`scripts` ã‚’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«å®šç¾©ã™ã‚‹ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ã¯ãªããªã‚Šã¾ã—ãŸã€‚
https://github.com/TakaShinoda/portfolio_v4.0/pull/44/commits/66b400f24da7d04ae510e15626379f36d8fc1687

```
$ npm run lint:package

> lint:package
> npmPkgJsonLint .
```

https://npmpackagejsonlint.org/docs/rules/scripts/prefer-alphabetical-scripts/

### ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ `0` ç³»ã§ã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯å…¥ã‚Œãªã„

`prefer-no-version-zero-dependencies` ã¨ `prefer-no-version-zero-devDependencies` ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã“ã¨ã§ã€ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ `0` ç³»ã§ã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã§ãã¾ã™ã€‚

```diff: npmpackagejsonlint.config.js
const config = {
  rules: {
    'prefer-alphabetical-scripts': 'error',
+   'prefer-no-version-zero-dependencies': 'error',
+   'prefer-no-version-zero-devDependencies': 'error'
  }
}

module.exports = config
```

```
$ npm run lint:package

> lint:package
> npmPkgJsonLint .


./package.json
âœ– prefer-no-version-zero-dependencies - node: dependencies - You have invalid version 0 dependencies. Please use modules with a major version >= 1. Invalid dependencies include: next-themes, typesync
1 error
0 warnings
```

https://npmpackagejsonlint.org/docs/rules/dependencies/prefer-no-version-zero-dependencies/
https://npmpackagejsonlint.org/docs/rules/dependencies/prefer-no-version-zero-devdependencies/

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼ˆ`~` ã‚„ `^` ã‚’ã¤ã‘ãªã„ï¼‰

`prefer-absolute-version-dependencies` ã¨ `prefer-absolute-version-devDependencies` ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã“ã¨ã§ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã« `~` ã‚„ `^` ãŒã‚ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã§ãã¾ã™ã€‚

```diff: npmpackagejsonlint.config.js
const config = {
  rules: {
    'prefer-alphabetical-scripts': 'error',
    'prefer-no-version-zero-dependencies': 'error',
    'prefer-no-version-zero-devDependencies': 'error',
+   'prefer-absolute-version-dependencies': 'error',
+   'prefer-absolute-version-devDependencies': 'error'
  }
}

module.exports = config
```

```
$ npm run lint:package

> lint:package
> npmPkgJsonLint .


./package.json
âœ– prefer-absolute-version-dependencies - node: dependencies - You are using an invalid version range. Please use absolute versions. Invalid dependencies include: @radix-ui/react-avatar, clsx, dayjs, iconoir-react, next, next-international, next-themes, tailwind-merge, typesync, vercel
âœ– prefer-absolute-version-devDependencies - node: devDependencies - You are using an invalid version range. Please use absolute versions. Invalid devDependencies include: @testing-library/jest-dom, @testing-library/react, @types/fs-extra, @types/testing-library__jest-dom, autoprefixer, fs-extra, jest, jest-environment-jsdom, npm-package-json-lint, postcss, rss-parser, tailwindcss, ts-node
2 errors
0 warnings
```

https://npmpackagejsonlint.org/docs/rules/dependencies/prefer-absolute-version-dependencies/
https://npmpackagejsonlint.org/docs/rules/dependencies/prefer-absolute-version-devdependencies/

# ãŠã‚ã‚Šã«

npm-package-json-lint ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€`package.json` ã«ãŠã„ã¦ã‚‚ linter ã®æ©æµã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
ãƒ«ãƒ¼ãƒ«ã‚‚è±Šå¯Œã«ã‚ã‚‹ã®ã§ã€ãã‚Œãã‚Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¿œã˜ãŸè¨­å®šãŒæŸ”è»Ÿã«ã§ããã†ã ã¨æ€ã„ã¾ã—ãŸã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®æ±ºã¾ã‚Šäº‹ã¯ã€ãã‚Œã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã«å¯èƒ½ã§ã‚ã‚Œã°ä»•çµ„ã¿åŒ–ã§ãã‚‹ã¨å¬‰ã—ã„ãªã¨ã‚ã‚‰ãŸã‚ã¦æ€ã„ã¾ã—ãŸã€‚
